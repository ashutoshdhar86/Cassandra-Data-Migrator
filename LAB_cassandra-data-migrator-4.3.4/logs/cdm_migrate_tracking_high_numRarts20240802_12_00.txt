24/08/02 12:00:24 INFO Migrate$: ################################################################################################
24/08/02 12:00:24 INFO Migrate$: ###                                  Migrate Job - Starting                                  ###
24/08/02 12:00:24 INFO Migrate$: ################################################################################################
24/08/02 12:00:24 INFO SparkContext: Running Spark version 3.5.1
24/08/02 12:00:24 INFO SparkContext: OS info Linux, 4.18.0-553.6.1.el8.x86_64, amd64
24/08/02 12:00:24 INFO SparkContext: Java version 11.0.20.1
24/08/02 12:00:24 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
24/08/02 12:00:24 INFO ResourceUtils: ==============================================================
24/08/02 12:00:24 INFO ResourceUtils: No custom resources configured for spark.driver.
24/08/02 12:00:24 INFO ResourceUtils: ==============================================================
24/08/02 12:00:24 INFO SparkContext: Submitted application: Migrate Job
24/08/02 12:00:24 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
24/08/02 12:00:24 INFO ResourceProfile: Limiting resource is cpu
24/08/02 12:00:24 INFO ResourceProfileManager: Added ResourceProfile id: 0
24/08/02 12:00:24 INFO SecurityManager: Changing view acls to: automaton
24/08/02 12:00:24 INFO SecurityManager: Changing modify acls to: automaton
24/08/02 12:00:24 INFO SecurityManager: Changing view acls groups to: 
24/08/02 12:00:24 INFO SecurityManager: Changing modify acls groups to: 
24/08/02 12:00:24 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: automaton; groups with view permissions: EMPTY; users with modify permissions: automaton; groups with modify permissions: EMPTY
24/08/02 12:00:25 INFO Utils: Successfully started service 'sparkDriver' on port 34285.
24/08/02 12:00:25 INFO SparkEnv: Registering MapOutputTracker
24/08/02 12:00:25 INFO SparkEnv: Registering BlockManagerMaster
24/08/02 12:00:25 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
24/08/02 12:00:25 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
24/08/02 12:00:25 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
24/08/02 12:00:25 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-a0bf45ad-db4c-4686-9a80-c4e42aa0e6e7
24/08/02 12:00:25 INFO MemoryStore: MemoryStore started with capacity 1048.8 MiB
24/08/02 12:00:25 INFO SparkEnv: Registering OutputCommitCoordinator
24/08/02 12:00:25 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
24/08/02 12:00:25 INFO Utils: Successfully started service 'SparkUI' on port 4040.
24/08/02 12:00:25 INFO SparkContext: Added JAR file:/home/automaton/LAB_cassandra-data-migrator-4.3.4/cassandra-data-migrator-4.3.4.jar at spark://ip-10-166-69-127.us-west-2.compute.internal:34285/jars/cassandra-data-migrator-4.3.4.jar with timestamp 1722600024383
24/08/02 12:00:25 INFO Executor: Starting executor ID driver on host ip-10-166-69-127.us-west-2.compute.internal
24/08/02 12:00:25 INFO Executor: OS info Linux, 4.18.0-553.6.1.el8.x86_64, amd64
24/08/02 12:00:25 INFO Executor: Java version 11.0.20.1
24/08/02 12:00:26 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
24/08/02 12:00:26 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@341b13a8 for default.
24/08/02 12:00:26 INFO Executor: Fetching spark://ip-10-166-69-127.us-west-2.compute.internal:34285/jars/cassandra-data-migrator-4.3.4.jar with timestamp 1722600024383
24/08/02 12:00:26 INFO TransportClientFactory: Successfully created connection to ip-10-166-69-127.us-west-2.compute.internal/10.166.69.127:34285 after 58 ms (0 ms spent in bootstraps)
24/08/02 12:00:26 INFO Utils: Fetching spark://ip-10-166-69-127.us-west-2.compute.internal:34285/jars/cassandra-data-migrator-4.3.4.jar to /tmp/spark-5d5793a9-5af4-4f9d-bb39-d224fd06bc67/userFiles-d0321054-5194-45ea-b557-1891bc144d4b/fetchFileTemp11249655766163256391.tmp
24/08/02 12:00:26 INFO Executor: Adding file:/tmp/spark-5d5793a9-5af4-4f9d-bb39-d224fd06bc67/userFiles-d0321054-5194-45ea-b557-1891bc144d4b/cassandra-data-migrator-4.3.4.jar to class loader default
24/08/02 12:00:26 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 44611.
24/08/02 12:00:26 INFO NettyBlockTransferService: Server created on ip-10-166-69-127.us-west-2.compute.internal:44611
24/08/02 12:00:26 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
24/08/02 12:00:26 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, ip-10-166-69-127.us-west-2.compute.internal, 44611, None)
24/08/02 12:00:26 INFO BlockManagerMasterEndpoint: Registering block manager ip-10-166-69-127.us-west-2.compute.internal:44611 with 1048.8 MiB RAM, BlockManagerId(driver, ip-10-166-69-127.us-west-2.compute.internal, 44611, None)
24/08/02 12:00:26 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, ip-10-166-69-127.us-west-2.compute.internal, 44611, None)
24/08/02 12:00:26 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, ip-10-166-69-127.us-west-2.compute.internal, 44611, None)
24/08/02 12:00:26 INFO PropertyHelper: Processing explicitly set and known sparkConf properties
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.autocorrect.missing] is configured with value [false] and is type [BOOLEAN]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.schema.origin.keyspaceTable] is configured with value [ks1.cdm] and is type [STRING]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.perfops.batchSize] is configured with value [5] and is type [NUMBER]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.perfops.ratelimit.origin] is configured with value [20000] and is type [NUMBER]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.perfops.numParts] is configured with value [1000000] and is type [NUMBER]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.connect.origin.host] is configured with value [10.166.65.33] and is type [STRING]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.autocorrect.missing.counter] is configured with value [false] and is type [BOOLEAN]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.connect.origin.password] is configured with value [********] and is type [STRING]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.trackRun.previousRunId] is configured with value [0] and is type [NUMBER]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.trackRun] is configured with value [true] and is type [BOOLEAN]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.connect.target.password] is configured with value [********] and is type [STRING]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.connect.target.username] is configured with value [cassandra] and is type [STRING]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.perfops.ratelimit.target] is configured with value [20000] and is type [NUMBER]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.autocorrect.mismatch] is configured with value [false] and is type [BOOLEAN]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.connect.target.host] is configured with value [10.166.65.248] and is type [STRING]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.connect.target.port] is configured with value [9042] and is type [NUMBER]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.connect.origin.port] is configured with value [9042] and is type [NUMBER]
24/08/02 12:00:26 INFO PropertyHelper: Known property [spark.cdm.connect.origin.username] is configured with value [cassandra] and is type [STRING]
24/08/02 12:00:26 INFO PropertyHelper: Adding any missing known properties that have default values
24/08/02 12:00:26 INFO ConnectionFetcher: PARAM --  SSL Enabled: false
24/08/02 12:00:26 INFO ConnectionFetcher: Connecting to ORIGIN at 10.166.65.33:9042
24/08/02 12:00:28 INFO ConnectionFetcher: PARAM --  SSL Enabled: false
24/08/02 12:00:28 INFO ConnectionFetcher: Connecting to TARGET at 10.166.65.248:9042
24/08/02 12:00:28 INFO DefaultMavenCoordinates: Apache Cassandra Java Driver (org.apache.cassandra:java-driver-core-shaded) version 4.18.1
24/08/02 12:00:28 INFO CqlPrepareAsyncProcessor: Adding handler to invalidate cached prepared statements on type changes
24/08/02 12:00:29 INFO Clock: Using native clock for microsecond precision
24/08/02 12:00:29 WARN PlainTextAuthProviderBase: [] /10.166.65.33:9042 did not send an authentication challenge; This is suspicious because the driver expects authentication
24/08/02 12:00:29 WARN DefaultTopologyMonitor: [s0] Unable to determine broadcast RPC port.  Trying to fall back to port used by the control connection.
24/08/02 12:00:29 WARN PlainTextAuthProviderBase: [] /10.166.65.33:9042 did not send an authentication challenge; This is suspicious because the driver expects authentication
24/08/02 12:00:30 INFO CassandraConnector: Connected to Cassandra cluster.
24/08/02 12:00:30 INFO Migrate$: PARAM -- Min Partition: -9223372036854775808
24/08/02 12:00:30 INFO Migrate$: PARAM -- Max Partition: 9223372036854775807
24/08/02 12:00:30 INFO Migrate$: PARAM -- Number of Splits : 1000000
24/08/02 12:00:30 INFO Migrate$: PARAM -- Track Run : true
24/08/02 12:00:30 INFO Migrate$: PARAM -- Previous RunId : 0
24/08/02 12:00:30 INFO Migrate$: PARAM -- Coverage Percent: 100
24/08/02 12:00:30 INFO CqlPrepareAsyncProcessor: Adding handler to invalidate cached prepared statements on type changes
24/08/02 12:00:30 INFO Clock: Using native clock for microsecond precision
24/08/02 12:00:30 WARN PlainTextAuthProviderBase: [] /10.166.65.248:9042 did not send an authentication challenge; This is suspicious because the driver expects authentication
24/08/02 12:00:30 WARN PlainTextAuthProviderBase: [] /10.166.65.248:9042 did not send an authentication challenge; This is suspicious because the driver expects authentication
24/08/02 12:00:30 INFO CassandraConnector: Connected to Cassandra cluster.
24/08/02 12:00:30 INFO SplitPartitions: ThreadID: 1 Splitting min: -9223372036854775808 max: 9223372036854775807
24/08/02 12:00:33 INFO Migrate$: PARAM Calculated -- Total Partitions: 1000000
24/08/02 12:00:35 INFO Migrate$: Spark parallelize created : 1000000 slices!
24/08/02 12:00:35 INFO CopyJobSession: PARAM -- Origin Rate Limit: 20000.0
24/08/02 12:00:35 INFO CopyJobSession: PARAM -- Target Rate Limit: 20000.0
24/08/02 12:00:35 INFO WritetimeTTL: PARAM -- Automatic TTLCols: [c3, c4]
24/08/02 12:00:35 INFO WritetimeTTL: PARAM -- Automatic WriteTimestampCols: [c3, c4]
24/08/02 12:00:35 INFO WritetimeTTL: Feature WritetimeTTL is enabled
24/08/02 12:00:35 INFO CopyJobSession: CQL -- origin select: SELECT pk1,ck1,c3,c4,TTL(c3),TTL(c4),WRITETIME(c3),WRITETIME(c4) FROM ks1.cdm WHERE TOKEN(pk1) >= ? AND TOKEN(pk1) <= ? ALLOW FILTERING
24/08/02 12:00:35 INFO CopyJobSession: CQL -- target select: SELECT pk1,ck1,c3,c4 FROM ks1.cdm WHERE pk1=? AND ck1=?
24/08/02 12:00:35 INFO CopyJobSession: CQL -- target upsert: INSERT INTO ks1.cdm (pk1,ck1,c3,c4) VALUES (?,?,?,?) USING TTL ? AND TIMESTAMP ?
24/08/02 12:02:30 INFO SerialShutdownHooks: Successfully executed shutdown hook: Clearing session cache for C* connector
24/08/02 12:02:30 INFO SparkContext: Invoking stop() from shutdown hook
24/08/02 12:02:30 INFO SparkContext: SparkContext is stopping with exitCode 0.
24/08/02 12:02:30 INFO SparkUI: Stopped Spark web UI at http://ip-10-166-69-127.us-west-2.compute.internal:4040
24/08/02 12:02:30 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
24/08/02 12:02:30 INFO MemoryStore: MemoryStore cleared
24/08/02 12:02:30 INFO BlockManager: BlockManager stopped
24/08/02 12:02:30 INFO BlockManagerMaster: BlockManagerMaster stopped
24/08/02 12:02:30 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
24/08/02 12:02:30 INFO SparkContext: Successfully stopped SparkContext
24/08/02 12:02:30 INFO ShutdownHookManager: Shutdown hook called
24/08/02 12:02:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-5d5793a9-5af4-4f9d-bb39-d224fd06bc67
24/08/02 12:02:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-4e2e5bb3-4d3b-43f1-9d2a-423fb02b5a63
